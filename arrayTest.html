<!DOCTYPE html>

<!--

 TO DO:
Prevent splitTheBill from rounding up results that divide correctly.
Require at least one entry in NameAray before allowing submit



 -->

<html>

<head>
  <script src="js/jquery-3.2.1.js"></script>
  <script src="js/accounting.js"></script>
</head>

<body>
  <script type="text/javascript">
    var nameArray = []
    var costArray = []



    function addName() {
      var check;
      check = document.getElementById("inputName").value;
      if (check == "") {
        alert("Please enter a name");
        return false;
      };

      var x = document.getElementById("boxNames");
      nameArray.push(document.getElementById("inputName").value);
      x.innerHTML = nameArray.join('<br/>');
    }

    function removeName() {
      var x = document.getElementById("boxNames");
      nameArray.pop(document.getElementById("inputName").value);
      x.innerHTML = nameArray.join('<br/>');
    }

    function addFoodItem() {
      var check;
      check = document.getElementById("inputCost").value;
      if (check == "" || check <= 0) {
        alert("Please enter a number greater than 0");
        return false;
      };
      var y = document.getElementById("boxCost");
      costArray.push(document.getElementById("inputCost").value);
      y.innerHTML = costArray.join('<br/>');
    }

    function removeFoodItem() {
      var y = document.getElementById("boxCost");
      costArray.pop(document.getElementById("inputCost").value);
      y.innerHTML = costArray.join('<br/>');
    }

    function subTotal(total, num) {
      return total + Math.round(num);
    }

    function addTip(subtotal) {
      var check;
      check = document.getElementById("inputTip").value;
      if (check == "" || check < 0) {
        alert("Please enter a tip equal to or greater than 0");
        return false;
      };
      var theTip = ((document.getElementById("inputTip").value))
      return accounting.toFixed((subtotal * theTip), 2)


    }

    function addTax(subtotal) {
      var check;
      check = document.getElementById("inputTax").value;
      if (check == "" || check < 0) {
        alert("Please enter a tax rate equal to or greater than 0");
        return false;
      };
      var theTax = ((document.getElementById("inputTax").value))
      return accounting.toFixed((subtotal * theTax), 2)


    }

    function truncate(num, decimal) {
      decimal = 2
      return accounting.toFixed(num, decimal);
    }

    function splitTheBill(item) {
      priceOfMeal = costArray.reduce(subTotal, 0);
      beforeTipandTax = (costArray.reduce(subTotal, 0) / nameArray.length);
      priceOfMealSplit = truncate(beforeTipandTax)
      tipAmount = addTip(beforeTipandTax) / 100
      taxAmount = addTax(beforeTipandTax) / 100
      grossTotal = truncate(beforeTipandTax + taxAmount + tipAmount);
      grandTotal = document.getElementById("priceOfMeal").innerHTML = "$" + priceOfMeal
      document.getElementById("cost-of-food").innerHTML = "$" + priceOfMealSplit
      document.getElementById("tip").innerHTML = "$" + truncate(tipAmount)
      document.getElementById("tax").innerHTML = "$" + truncate(taxAmount)
      document.getElementById("sumTotal").innerHTML = "$" + grossTotal;


    };
  </script>

  <form action="" method="post">

    <input id="inputName" type=text>
    <input type=button onclick="addName()" value="Add Name" />
    <input type=button onclick="removeName()" value="Remove Name" />
    <div id="boxNames" ; style="border:1px solid black;width:150px;height:150px;overflow:auto"></div>




    <div class="input-group">
      <input id="inputCost" type="number" placeholder="$" min="0" class="form-control inputNumber">
      <span class="input-group-addon"></span>
      <input type=button onclick="addFoodItem()" value="Add Food" />
      <input type=button onclick="removeFoodItem()" value="Remove Food" />
      <div id="boxCost" ; style="border:1px solid black;width:150px;height:150px;overflow:auto"></div>
    </div>

    <div class="tip-and-tax">
      <label>Tax Rate</label><br>
      <input type="number" class="form-control inputNumber" id="inputTax" min="0" onchange="addTax()">
      <span class="input-group-addon">%</span> <br>
      <label>Tip Amount</label><br>
      <input type="number" class="form-control" id="inputTip" min="0" onchange="addTip()">
      <span class="input-group-addon">%</span>
    </div>

    <input type=button onclick="splitTheBill(subTotal)" value="Split the Bill!" />
    <p>Total Cost of Meal: <span id="priceOfMeal"></span></p>
    <p>Per Person: <span id="cost-of-food"></span></p>
    <p>Tax: <span id="tax"></span></p>
    <p>Tip: <span id="tip"></span></p>
    <p>Your Total: <span id="sumTotal"></span></p>



  </form>
</body>

</html>
